<div class="row">

  <div class="col">
    <ul class="list-unstyled">
      <% obj.dossiers.each do |dossier| %>

        <%= tag.li(class: 'media mb-4', id: element_id(dossier)) do %>

          <%= tag.a(href: polymorphic_path([dossier.try(:world), dossier])) do %>
            <%= default_image(dossier, 'mr-3 q-media-img-default') %>
          <% end %>

          <%# Body %>
          <div class="media-body">
            <h5 class="mb-1">
              <%= dossier.name %>
            </h5>
            <p class="small mb-0 text-muted">
            <% if dossier.description.present? %>
              <%= dossier.description %>
              <br />
            <% end %>

            <%# Attachment statistics%>
            <%# FIXME: Refactor - create a helper %>
            <span class="small text-muted">
              <%= icon(:image) %>&nbsp;<%= dossier.images.count %>&nbsp;
              <%= icon(:audio) %>&nbsp;<%= dossier.audios.count %>&nbsp;
              <%= icon(:video) %>&nbsp;<%= dossier.videos.count %>&nbsp;
              <%= icon(:file) %>&nbsp; <%= dossier.other_files.count %>&nbsp;
            </span>
            </p>

            <%# FIXME: Refactor menu %>
            <nav class="nav small">
              <%= link_to(
                t('show'),
                polymorphic_path([dossier.try(:world), dossier]),
                class: 'nav-link pr-2 pl-0 py-0') %>
              <%= link_to(
                icon(:edit),
                edit_polymorphic_path([dossier.try(:world), dossier]),
                class: 'nav-link px-2 py-0',
                id: element_id(dossier, 'edit')) %>
              <%= link_to(
                icon(:delete),
                polymorphic_path([dossier.try(:world), dossier]),
                id: element_id(dossier, 'delete'),
                class: 'nav-link px-2 py-0',
                data: { confirm: t('.confirm_delete', dossier: dossier.name) },
                method: :delete) %>
            </nav>
          </div>

        <% end %>

      <% end %>
    </ul>
  </div>

</div>

<div class="row">
  <div class="col text-right">
    <%= link_to(icon(:new), new_polymorphic_path([obj.try(:world), obj, Dossier]), id: 'add-dossier') %>
  </div>
</div>

